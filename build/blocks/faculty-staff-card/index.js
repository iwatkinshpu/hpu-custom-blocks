(()=>{"use strict";var e,s={958:()=>{const e=window.wp.blocks,s=window.wp.element,t=window.wp.blockEditor,r=window.wp.components,a=window.ReactJSXRuntime;function o(e){const[t,o]=(0,s.useState)(e.postID||null),[l,i]=(0,s.useState)(null),[n,c]=(0,s.useState)([]),[d,p]=(0,s.useState)(!1),[h,u]=(0,s.useState)(!1),[f,m]=(0,s.useState)(!1),v=(0,s.useRef)(""),j=s=>{o(s),"function"==typeof e.onChange&&e.onChange(s)},x=e=>e?.replace(/^\/|\/$/,"")||"",w=(0,s.useCallback)((()=>{const s=e?.apiNameSpace?"":"posts",t=x(e?.apiDomain)||window.location.origin,r=e?.blogID?(async(e,s)=>{try{const t=e+"/wp-json/hpu/v1/blogs?id="+s;await fetch(t)}catch{}})(t,e.blogID):"/",a=x(e?.apiNameSpace)||"wp-json/wp/v2",o=x(e?.postType)||s;return x(`${t}${r}${a}/${o}`)}),[e.apiDomain,e.apiNameSpace,e.postType]);return(0,s.useEffect)((()=>{if(!f)return c([]),void p(!1);p(!0);const e=setTimeout((async()=>{try{const e=w()+(v.current?`?search=${v.current}&per_page=20`:"?per_page=20&orderby=date"),s=await fetch(e);if(s.ok){const e=await s.json();c(e.map((e=>({label:e?.title?.rendered||"Untitled",value:e.id}))))}}catch(e){console.log("Error fetching posts: ",e)}finally{p(!1)}}),200);return()=>clearTimeout(e)}),[f,w]),(0,s.useEffect)((()=>{t?(async()=>{try{const e=w(),s=await fetch(`${e}/${t}`);if(s.ok){const e=await s.json();i(e)}}catch(e){console.log("Error fetching selected post: ",e)}})():i(null)}),[t,w]),(0,a.jsxs)("div",{className:"post-search-control",children:[l&&(0,a.jsxs)("div",{className:"post-search-control-selected",children:[(0,a.jsx)("label",{children:"Currently selected"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:l.title?.rendered||l.title}),(0,a.jsx)(r.Button,{variant:"tertiary",size:"small",isDestructive:!0,onClick:()=>{j(null)},children:"X"})]})]}),(0,a.jsx)(r.SearchControl,{className:"post-search-control-selector",label:e.searchLabel||"Search Posts",hideLabelFromVision:!1,value:v.current,onChange:e=>{v.current=e,m(e),u(!0)},__nextHasNoMarginBottom:!0}),h&&(0,a.jsx)(r.Popover,{className:"post-search-control-results",onClose:()=>u(!1),position:"bottom",children:(0,a.jsxs)("ul",{className:"search-results","aria-live":"polite",children:[d&&(0,a.jsx)(r.Spinner,{}),n.map((e=>(0,a.jsx)("li",{role:"button",tabIndex:0,onClick:()=>{j(e.value),u(!1)},children:e.label},e.value))),!d&&0===n.length&&(0,a.jsx)("li",{className:"no-results",children:"No Results Found. Sorry."})]})})]})}(0,e.registerBlockType)("hpu/faculty-staff-card",{edit:function({attributes:e,setAttributes:r}){var l;const{postID:i}=e,[n,c]=(0,s.useState)(null);(0,s.useEffect)((()=>{i?(async()=>{const e=await fetch(`${window.location.origin}/wp-json/hpu/v1/directory?id=${i}`);if(e.ok){const s=await e.json();c(s[0])}})():c(null)}),[i]);const d=e=>e.replace(/^[^\d]*\+?1?[^\d]*(\d{3})[^\d]*(\d{3})[^\d]*(\d{4})[^\d]*$/,"+1 ($1) $2-$3");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.InspectorControls,{children:(0,a.jsx)(o,{postID:i,postType:"faculty-staff",label:"Select Directory Profile",onChange:e=>{r({postID:e})}})}),(0,a.jsx)("div",{...(0,t.useBlockProps)(),children:n?(0,a.jsxs)("div",{className:"profile-card",children:[n.image&&(0,a.jsx)("div",{className:"profile-card-image",children:(0,a.jsx)("img",{src:null!==(l=n.image?.thumbnail)&&void 0!==l?l:n.image?.url,alt:n.title+" Profile Photo"})}),(0,a.jsxs)("div",{className:"profile-card-text",children:[(0,a.jsx)("div",{className:"profile-card-title profile-selected",children:(0,a.jsx)("a",{"data-preview-href":n.link,children:n.title})}),n.job_role&&(0,a.jsx)("div",{className:"profile-card-role",children:n.job_role}),n.email&&(0,a.jsxs)("div",{className:"profile-card-email",children:[(0,a.jsx)("span",{className:"icon"}),(0,a.jsx)("a",{"data-preview-href":`mailto:${n.email}`,children:n.email})]}),n.phone&&(0,a.jsxs)("div",{className:"profile-card-phone",children:[(0,a.jsx)("span",{className:"icon"}),(0,a.jsx)("a",{"data-preview-href":`tel:${d(n.phone)}`,children:d(n.phone)})]})]})]}):(0,a.jsx)("div",{className:"profile-card profile-not-selected",children:(0,a.jsx)("span",{children:"Please Select a Directory Profile from the side bar."})})})]})}})}},t={};function r(e){var a=t[e];if(void 0!==a)return a.exports;var o=t[e]={exports:{}};return s[e](o,o.exports,r),o.exports}r.m=s,e=[],r.O=(s,t,a,o)=>{if(!t){var l=1/0;for(d=0;d<e.length;d++){t=e[d][0],a=e[d][1],o=e[d][2];for(var i=!0,n=0;n<t.length;n++)(!1&o||l>=o)&&Object.keys(r.O).every((e=>r.O[e](t[n])))?t.splice(n--,1):(i=!1,o<l&&(l=o));if(i){e.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,a,o]},r.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={973:0,57:0};r.O.j=s=>0===e[s];var s=(s,t)=>{var a,o,l=t[0],i=t[1],n=t[2],c=0;if(l.some((s=>0!==e[s]))){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(n)var d=n(r)}for(s&&s(t);c<l.length;c++)o=l[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(d)},t=self.webpackChunkhpu_custom_blocks=self.webpackChunkhpu_custom_blocks||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var a=r.O(void 0,[57],(()=>r(958)));a=r.O(a)})();